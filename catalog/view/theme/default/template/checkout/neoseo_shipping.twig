{% if error_warning is defined and error_warning %}
    <div class="warning">{{ error_warning }}</div>
{% endif %}

{% set exists = constant('false') %}
{% for shipping_method in shipping_methods if not exists %}
    {% for quote in shipping_method['quote'] %}
        {% if (quote['code'] == code) %}
            {% set exists = constant('true') %}
        {% endif %}
    {% endfor %}
{% endfor %}

{% if not shipping_methods %}
    {% if not city %}
        <div class="alert alert-danger"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span> {{ error_city }}</div>
    {% endif %}
{% else %}
    {% if neoseo_checkout_shipping_control %}
        <div id="shipping_methods" class="form-group row">
        <div class="col-sm-12">
        {% if neoseo_checkout_use_shipping_type %}
            <div class="field">
                <div class="shipping-tabs-holder">
                    <div class="title-label">{{ text_shipping_method }}</div>
                    <div class="shipping-tabs">
                        <div class='radio radio-primary radio-inline'>
                            <input id="shipping_pickpoint" type="radio" name="neoseo_checkout_shipping_type" checked="checked"/>
                            <label for="shipping_pickpoint">Забрать самостоятельно</label>
                        </div>
                        <div class='radio radio-primary radio-inline'>
                            <input id="shipping_address" type="radio" name="neoseo_checkout_shipping_type" />
                            <label for="shipping_address">Заказать доставку</label>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
        {% for key,shipping_method in shipping_methods %}
            {% if neoseo_checkout_shipping_title %}
                <div class="shipping-method-title"><b>{{ shipping_method['title'] }}</b></div>
            {% endif %}

            {% if not shipping_method['error'] %}
                {% for quote in shipping_method['quote'] %}
                    <div style="display: inline-block; margin-right: 15px;" class="type-{{ quote['type'] }} field" {% if neoseo_checkout_compact %}style="display: inline-block; margin-right: 1em;"{% endif %}>
                        <div class='radio radio-primary {% if neoseo_checkout_compact %}radio-inline{% endif %}'>
                        {% if quote['code'] == code or not code or not exists %}
                            {% set code = quote['code'] %}
                            {% set exists = constant('true') %}
                            <input type="radio" name="shipping_method" value="{{ quote['code'] }}" id="{{ quote['code'] }}" checked="checked" />
                        {% else %}
                            <input type="radio" name="shipping_method" value="{{ quote['code'] }}" id="{{ quote['code'] }}" />
                        {% endif %}
                        <label for="{{ quote['code'] }}">{{ quote['title'] }} {% if (key == "neoseo_novaposhta") %} {{ quote['text'] }}{% endif %}</label>
                        </div>
                    {% if ( constant('false') and quote['description'] is defined) %} <br><small>{{ quote['description'] }}</small>{% endif %}
                    </div>
                {% endfor %}
                {% if ( neoseo_checkout_use_shipping_type ) %}<script>
                if( $('#shipping_methods div.type-pickpoint').length > 0 ) {
                    $('#shipping_pickpoint').prop('checked', 'checked');
                    $('#shipping_methods div.type-address').hide();
                } else {
                    $('#shipping_address').prop('checked', 'checked');
                    $('#shipping_methods div.type-pickpoint').hide();
                }
                </script>
                {% endif %}
            {% else %}
                <div class="error">{{ shipping_method['error'] }}</div>
            {% endif %}
        {% endfor %}
        </div>
        </div>
    {% else %}
        <select class="large-field" name="shipping_method" id="shipping_methods">
            {% for shipping_method in shipping_methods %}
                {% for quote in shipping_method['quote'] %}
                    {% if (quote['code'] == code or not code or not exists) %}
                        {% set code = quote['code'] %}
                        {% set exists = constant('true') %}
                    <option value="{{ quote['code'] }}" selected="selected">
                    {% else %}
                        <option value="{{ quote['code'] }}">
                    {% endif %}
                    {{ quote['title'] }}&nbsp;&nbsp;({{ quote['text'] }}) </option>
                {% endfor %}
            {% endfor %}
        </select>
    {% endif %}
{% endif %}

<div id="shipping-method-fields" class=""></div>
<div id="shipping-method-info" class="field text-block"></div>