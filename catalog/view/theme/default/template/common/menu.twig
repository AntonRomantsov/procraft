{% if categories %}

	<a href="{{ catalog }}" type="button" class="main-menu__button main-menu__button-js">
		<span class="main-menu__button-deco">
            <svg><use href="catalog/view/theme/default/image/icons.svg#catalog"></use></svg>
        </span>
        {{ text_category }}
    </a>
	<div class="main-nav__collapse">
		<ul class="main-nav__list list-unstyled">
			{% for category in categories %}
			{% if category.children %}
			<li class="main-nav__item main-nav__item--{{ category.category_id }}">
				<a href="{{ category.href }}" class="main-nav__link">
					<svg class="svg-icon">
						<use xlink:href="/image/sprite-category.svg#{{ category.category_id }}"></use>
					</svg>
					{{ category.name }}
					<i class="fa fa-angle-right"></i>
				</a>
				<div class="main-nav__dropdown main-nav-dropdown">
					<div class="main-nav-dropdown__inner"> {% for children in category.children|batch(category.children|length / category.column|round(1, 'ceil')) %}
						<ul class="main-nav-dropdown__list list-unstyled">
							{% if category.category_id == 73 %}
							<li class="main-nav-dropdown__item"><a class="main-nav-dropdown__link" href="{{ href_acum }}"><img class="main-nav-dropdown__img" src="/image/acum.jpg" alt="" style="width: 70px; height: 70px;"><span style="margin-top: 10px">{{ text_acum }}</span></a></li>
							{% endif %}
							{% for child in children %}
							<li class="main-nav-dropdown__item"><a class="main-nav-dropdown__link" href="{{ child.href }}"><img class="main-nav-dropdown__img" src="{{ child.image }}" alt="">{{ child.name }}</a></li>
							{% endfor %}
						</ul>
						{% endfor %}</div>
					</div>
			</li>
			{% else %}
			<li class="main-nav__item main-nav__item--{{ category.category_id }}"><a class="main-nav__link" href="{{ category.href }}"><svg class="svg-icon">
						<use xlink:href="/image/sprite-category.svg#{{ category.category_id }}"></use>
					</svg>{{ category.name }}</a></li>
			{% endif %}
			{% endfor %}
		</ul>
	</div>
	<button class="header__burger-button">
        <a id="burger" class="header__burger">
            <div></div>
        </a>
    </button>
    <nav id="mainMenu" class="mob-menu main-menu">
    <div class="main-menu__drop">
      <div class="main-menu__row">
        <a href="#" class="main-menu__row-logo">
          <img src="catalog/view/theme/default/image//header/logo.svg" alt="Logo" />
        </a>
        <div class="main-menu__row-languages">
          <button class="main-menu__row-button main-menu__row-button--active main-menu__row-ua">УКР</button>
          <span>|</span>
          <button class="main-menu__row-button main-menu__row-ru">РУС</button>
        </div>
      </div>
      <button type="button" class="main-menu__button-drop">
        <span class="main-menu__button-drop-deco">
          <svg><use href="catalog/view/theme/default/image/icons.svg#fire"></use></svg>
        </span>
        Каталог товарів
      </button>

      <button id="closeButton" class="main-menu__button-close">
        <span class="main-menu__button-close_icon">
          <svg><use href="catalog/view/theme/default/image/icons.svg#close"></use></svg>
        </span>
      </button>
      <ul class="main-menu__list">
      {% for category in categories %}
      {% if category.children %}
        <li class="main-menu__list-item">
          <a href="{{ category.href }}" class="main-menu__link">
            <svg class="main-menu__link-icon"><use href="/image/sprite-category.svg#{{ category.category_id }}"></use></svg>
            {{ category.name }}
          </a>
          <div class="main-nav__dropdown main-nav-dropdown">
            <div class="main-nav-dropdown__wrapper">
              <ul class="main-nav-dropdown__list">
                {% if category.category_id == 73 %}
                <li class="main-nav-dropdown__item">
                  <a class="main-nav-dropdown__link" href="{{ href_acum }}">
                    <img src="/image/acum.jpg" alt="" style="width: 70px; height: 70px;">
                    <p>{{ text_acum }}</p>
                  </a>
                </li>
                {% endif %}
                {% for child in category.children %}
                <li class="main-nav-dropdown__item">
                  <a class="main-nav-dropdown__link" href="{{ child.href }}">
                    <img src="{{ child.image }}" alt="Product" />
                    <p>{{ child.name }}</p>
                  </a>
                </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </li>
        {% else %}
        <li class="main-menu__list-item"><a class="main-menu__link" href="{{ category.href }}"><svg class="main-menu__link-icon">
          <use xlink:href="/image/sprite-category.svg#{{ category.category_id }}"></use>
        </svg>{{ category.name }}</a></li>
      {% endif %}
      {% endfor %}
      </ul>

      <ul class="main-menu__list--secondary desctop-none">
        <li class="main-menu__list-item">
          <a href="{{ link_special }}" class="main-menu__link">
            <svg class="main-menu__link-icon"><use href="catalog/view/theme/default/image/icons.svg#promotion"></use></svg>
            {{ text_special }}
          </a>
        </li>
        <li class="main-menu__list-item">
          <a href="{{ link_bestseller }}" class="main-menu__link">
            <svg class="main-menu__link-icon"><use href="catalog/view/theme/default/image/icons.svg#bestseller"></use></svg>
            {{ text_bestseller }}
          </a>
        </li>
        <li class="main-menu__list-item">
          <a href="{{ link_news }}" class="main-menu__link">
          <svg class="main-menu__link-icon" width="22" height="21" viewBox="0 0 22 21" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.74712 1.2573C9.47552 0.528902 10.5044 0.185956 11.5241 0.331635L17.3738 1.1673C18.8138 1.37301 19.9451 2.50438 20.1508 3.94431L20.9865 9.79404C21.1322 10.8138 20.7892 11.8427 20.0608 12.5711L12.0255 20.6063C11.635 20.9969 11.0019 20.9969 10.6113 20.6063L0.711843 10.7069C0.321313 10.3163 0.321313 9.68317 0.711843 9.29257L8.74712 1.2573ZM12.7327 8.58547C13.5137 9.36657 14.78 9.36657 15.5611 8.58547C16.3421 7.80445 16.3421 6.53812 15.5611 5.75707C14.78 4.97603 13.5137 4.97603 12.7327 5.75707C11.9516 6.53812 11.9516 7.80445 12.7327 8.58547Z" fill="#ed6e00"/>
          </svg>
            {{ text_news }}
          </a>
        </li>
        <li class="main-menu__list-item">
          <a href="javascript:void(0)" class="main-menu__link buyer-link" onclick="openSubMenu();">
          <svg class="main-menu__link-icon" width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.833496 20.1666C0.833496 16.1165 4.11674 12.8333 8.16683 12.8333C12.2169 12.8333 15.5002 16.1165 15.5002 20.1666H0.833496ZM8.16683 11.9166C5.12808 11.9166 2.66683 9.45538 2.66683 6.41663C2.66683 3.37788 5.12808 0.916626 8.16683 0.916626C11.2056 0.916626 13.6668 3.37788 13.6668 6.41663C13.6668 9.45538 11.2056 11.9166 8.16683 11.9166ZM14.9161 13.9637C17.7443 14.6865 19.8707 17.1632 20.0685 20.1666H17.3335C17.3335 17.7743 16.417 15.596 14.9161 13.9637ZM13.0619 11.8771C14.5586 10.5345 15.5002 8.58552 15.5002 6.41663C15.5002 5.1174 15.1623 3.89709 14.5697 2.83876C16.6692 3.25777 18.2502 5.11006 18.2502 7.33329C18.2502 9.86558 16.1991 11.9166 13.6668 11.9166C13.4618 11.9166 13.2598 11.9032 13.0619 11.8771Z" fill="#ed6e00"/>
          </svg>
            {{ text_buyer }}
          </a>
          <div class="main-nav--secondary__dropdown secondary-menu__dropdown">
            <div class="secondary-menu__wrapper">
              <ul class="secondary-menu__list-list">
                <li class="secondary-menu__item">
                  <a class="secondary-menu__link" href="{{ link_store }}">{{ text_store }}</a>
                </li>
                <li class="secondary-menu__item">
                  <a class="secondary-menu__link" href="{{ link_services }}">{{ text_services }}</a>
                </li>
                <li class="secondary-menu__item">
                  <a class="secondary-menu__link" href="{{ link_delivery }}">{{ text_delivery }}</a>
                </li>
                <li class="secondary-menu__item">
                  <a class="secondary-menu__link" href="{{ link_black_list }}">{{ text_black_list }}</a>
                </li>
              </ul>
            </div>
          </div>
        </li>
      </ul>
      <ul class="main-nav__contact">
        <li class="main-menu__list-item main-nav__contact-item">
          <a class="main-menu__link" href="callto:+380800333900" class="main-menu__link main-nav__contact-link">
          <svg class="main-menu__link-icon" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M18 13.42V16.9561C18 17.4811 17.5941 17.9167 17.0705 17.9537C16.6331 17.9846 16.2763 18 16 18C7.1634 18 0 10.8366 0 2C0 1.72371 0.01545 1.36687 0.04635 0.9295C0.08337 0.40588 0.51894 0 1.04386 0H4.5801C4.83678 0 5.05176 0.19442 5.07753 0.4498C5.10067 0.67907 5.12218 0.86314 5.14207 1.00202C5.34435 2.41472 5.75753 3.75936 6.3487 5.00303C6.44359 5.20265 6.38171 5.44159 6.20185 5.57006L4.04355 7.1118C5.35752 10.1811 7.8189 12.6425 10.8882 13.9565L12.4271 11.8019C12.5572 11.6199 12.799 11.5573 13.001 11.6532C14.2446 12.2439 15.5891 12.6566 17.0016 12.8584C17.1396 12.8782 17.3225 12.8995 17.5502 12.9225C17.8056 12.9483 18 13.1633 18 13.42Z" fill="#ed6e00"/>
          </svg>
            0 800 333 900
          </a>
        </li>
        <li class="main-menu__list-item main-nav__contact-item">
          <a href="mailto:info@procraft.ua" class="main-menu__link main-nav__contact-link">
          <svg class="main-menu__link-icon" width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 0H19C19.5523 0 20 0.44772 20 1V17C20 17.5523 19.5523 18 19 18H1C0.44772 18 0 17.5523 0 17V1C0 0.44772 0.44772 0 1 0ZM10.0606 8.6829L3.64722 3.2377L2.35278 4.7623L10.0731 11.3171L17.6544 4.75616L16.3456 3.24384L10.0606 8.6829Z" fill="#ed6e00"/>
          </svg>
            info@procraft.ua
          </a>
        </li>
      </ul>
      
    </div>
    <div class="main-menu__drop">
    <ul class="main-menu-gift">
      <li class="main-menu__list-item main-nav__contact-item">
        <a href="{{ link_special }}" class="main-menu__link main-nav__contact-link">
          <svg class="main-menu__link-icon"><use href="catalog/view/theme/default/image/icons.svg#promotion"></use></svg>
          {{ text_special }}
        </a>
      </li>
    </ul>
    </div>
  </nav> 

{% endif %} 
<script>
document.addEventListener("DOMContentLoaded", () => {
  if (window.innerWidth <= 1024) return;

  const mainMenu = document.querySelector(".main-menu2");
  const main = document.querySelector("main");

  if (!mainMenu) return;

  let activeDropdown = null;
  let activeSecondaryMenu = null;

  const activateDropdown = (menuItem) => {
    const dropdown = menuItem.querySelector(".main-nav-dropdown");

    if (dropdown) {
      deactivateDropdown();
      dropdown.classList.add("main-nav-dropdown--active");
      activeDropdown = dropdown;
      mainMenu.classList.add("main-nav-dropdown--active");
    } else {
      deactivateDropdown();
    }
  };

  const activateSecondaryMenu = (menuItem) => {
    const secondaryMenu = menuItem.querySelector(".secondary-menu__dropdown");

    if (secondaryMenu) {
      deactivateSecondaryMenu();
      secondaryMenu.classList.add("secondary-menu__dropdown--active");
      activeSecondaryMenu = secondaryMenu;
    }
  };

  const deactivateDropdown = () => {
    if (activeDropdown) {
      activeDropdown.classList.remove("main-nav-dropdown--active");
      activeDropdown = null;
    }
    mainMenu.classList.remove("main-nav-dropdown--active");
  };

  const deactivateSecondaryMenu = () => {
    if (activeSecondaryMenu) {
      activeSecondaryMenu.classList.remove("secondary-menu__dropdown--active");
      activeSecondaryMenu = null;
    }
  };

  const isCursorInside = (event, element) => {
    const rect = element.getBoundingClientRect();
    return event.clientX >= rect.left && event.clientX <= rect.right && event.clientY >= rect.top && event.clientY <= rect.bottom;
  };

  const menuItems = mainMenu.querySelectorAll(".main-menu__list-item");
  menuItems.forEach((menuItem) => {
    menuItem.addEventListener("mouseenter", () => activateDropdown(menuItem));

    const firstLink = menuItem.querySelector(".main-menu__link");
    if (firstLink) {
      firstLink.addEventListener("click", (event) => {
        const secondaryMenu = menuItem.querySelector(".secondary-menu__dropdown");
        if (secondaryMenu) {
          //event.preventDefault();
          activateSecondaryMenu(menuItem);
        }
      });
    }
  });

  document.addEventListener("mousemove", (event) => {
    if (!isCursorInside(event, mainMenu)) {
      deactivateDropdown();
      deactivateSecondaryMenu();
    }
  });
});




         $('.main-menu__button').mouseenter(() => {
            body.classList.add("menu-open");
            $('.main-menu2').css('position', 'fixed');
            $('.main-menu2').css('top', '144px');
            $('.main-menu2').css('z-index', '1000');
            let elem2 = document.querySelector('.header__main-menu');
            let coords = elem2.getBoundingClientRect();
            $('.main-nav__dropdown').addClass('scroll-dropdown');
            $('.main-menu2').css('left', coords.left + 'px');
        });
         $('.main-menu__button').mouseleave(event => {
          if(event.relatedTarget.getAttribute('class') != 'header__wrapper'){
            
            body.classList.remove("menu-open");
            $('.main-menu2').hide();
            $('.main-nav__dropdown').removeClass('scroll-dropdown');
          }
          $('.main-menu2').mouseleave(() => {
            body.classList.remove("menu-open");
            $('.main-menu2').hide();
            $('.main-nav__dropdown').removeClass('scroll-dropdown');
          });
        });
      
        $('.header__search').mouseenter(() => {
          body.classList.remove("menu-open");
          $('.main-menu2').hide();
          $('.main-nav__dropdown').removeClass('scroll-dropdown');
         });
      
        $('.header__actions-row').mouseenter(() => {
          body.classList.remove("menu-open");
          $('.main-menu2').hide();
          $('.main-nav__dropdown').removeClass('scroll-dropdown');
        }); 


	const burger = document.getElementById("burger");
	const menu = document.getElementById("mainMenu");
	const body = document.querySelector("body");
	const html = document.querySelector("html");
	const closeButton = document.getElementById("closeButton");
	
	if (burger && menu && body && html) {
	  burger.addEventListener("click", () => {
		if (burger) {
		  burger.classList.toggle("active");
		  if (burger.classList.contains("active")) {
			if (menu) menu.classList.add("main-menu--active");
			if (body) body.classList.add("overflow_hidden");
			if (html) html.classList.add("overflow_hidden");
		  } else {
			closeMenu();
		  }
		}
	  });
	
	  document.addEventListener("click", (event) => {
		if (menu && burger) {
		  const clickOnMenu = menu.contains(event.target);
		  const clickOnBurger = burger.contains(event.target);
		  if (!clickOnMenu && !clickOnBurger) {
			closeMenu();
		  }
		}
	  });
	
	  if (menu) {
		menu.addEventListener("click", (event) => {
		  if (event.target.tagName === "IMG") {
			closeMenu();
		  }
		});
	  }
	
	  if (closeButton) {
		closeButton.addEventListener("click", () => {
		  closeMenu();
		});
	  }
	
	  function resize() {
		const screenWidth = window.innerWidth;
		if (screenWidth > 1024) {
		  closeMenu();
		}
	  }
	  window.addEventListener("resize", resize);
	  resize();
	
	  function closeMenu() {
		if (menu) menu.classList.remove("main-menu--active");
		if (body) body.classList.remove("overflow_hidden");
		if (html) html.classList.remove("overflow_hidden");
		if (burger) burger.classList.remove("active");
	  }
	}

document.addEventListener("DOMContentLoaded", () => {
  const body = document.querySelector(".body");
  const mainMenu = document.querySelector(".mob-menu");
  const buttonDrop = document.querySelector(".main-menu__button-drop");
  const menuList = mainMenu.querySelector(".main-menu__list");
  const menuListSecondary = mainMenu.querySelector(".main-nav--secondary__dropdown");

  if (!mainMenu || !buttonDrop || !menuList) return;

  let activeDropdown = null;
  let activeSecondaryMenu = null;
  let isMobile = window.innerWidth <= 1024;

  const activateDropdown = (menuItem) => {
    const dropdown = menuItem.querySelector(".main-nav-dropdown");

    if (dropdown) {
      deactivateDropdown();
      dropdown.classList.add("main-nav-dropdown--active");
      activeDropdown = dropdown;
      mainMenu.classList.add("main-nav-dropdown--active");
    } else {
      deactivateDropdown();
    }
  };

  const deactivateDropdown = () => {
    if (activeDropdown) {
      activeDropdown.classList.remove("main-nav-dropdown--active");
      activeDropdown = null;
    }
    mainMenu.classList.remove("main-nav-dropdown--active");
  };

  const toggleMenuList = () => {
    buttonDrop.classList.toggle("main-menu__button-drop--active");
    if (buttonDrop.classList.contains("main-menu__button-drop--active")) {
      menuList.classList.add("main-menu__list--active");
    } else {
      menuList.classList.remove("main-menu__list--active");
    }
  };

  buttonDrop.addEventListener("click", () => {
    if (isMobile) {
      toggleMenuList();
    }
  });

  const showMenu = () => {
    mainMenu.classList.remove("header__main-menu_hidden--mod");
    //body.classList.add("menu-open");
    menuListSecondary.classList.add("secondary-menu__dropdown--active");
  };

  const hideMenu = () => {
    mainMenu.classList.add("header__main-menu_hidden--mod");
    //body.classList.remove("menu-open");
    menuListSecondary.classList.remove("secondary-menu__dropdown--active");
  };

  let isOverButton = false;
  let isOverMenu = false;
  let buttonMenu = document.querySelector(".main-menu__button-js");

  buttonMenu.addEventListener("mouseenter", () => {
    isOverButton = true;
    showMenu();
  });

  buttonMenu.addEventListener("mouseleave", () => {
    isOverButton = false;

    if (!isOverMenu && !isOverButton) {
      hideMenu();
    }
  });

  mainMenu.addEventListener("mouseenter", () => {
    isOverMenu = true;
    if (!isMobile) {
      showMenu();
    }
  });

  mainMenu.addEventListener("mouseleave", () => {
    isOverMenu = false;
    if (!isOverMenu && !isOverButton && !isMobile) {
      hideMenu();
    }
  });

  const menuItems = mainMenu.querySelectorAll(".main-menu__list-item");
  menuItems.forEach((menuItem) => {
    menuItem.addEventListener("click", (event) => {
      const dropdown = menuItem.querySelector(".main-nav-dropdown");

      if (dropdown) {
        event.preventDefault();
        dropdown.classList.toggle("main-nav-dropdown--active");
        activeDropdown = dropdown;
      } else {
        window.location.href = menuItem.querySelector("a").href;
      }
    });
  });

  window.addEventListener("resize", () => {
    isMobile = window.innerWidth <= 1024;
    if (!isMobile) {
      deactivateDropdown();
      buttonDrop.classList.remove("main-menu__button-drop--active");
      menuList.classList.remove("main-menu__list--active");
    }
  });
});
</script>